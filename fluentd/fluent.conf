<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Optional: collect container logs from docker socket if mounted later
# <source>
#   @type tail
#   path /var/log/containers/*.log
#   pos_file /fluentd/log/fluentd-docker.pos
#   tag kube.*
#   <parse>
#     @type json
#   </parse>
# </source>

<match **>
  @type elasticsearch
  host elasticsearch
  port 9200
  scheme http
  user elastic
  password ${ELASTIC_PASSWORD}
  logstash_format true
  logstash_prefix fluentd
  include_tag_key true
  type_name _doc
  reconnect_on_error true
  reload_on_failure true
  request_timeout 30s
  <buffer>
    @type file
    path /fluentd/buffer
    flush_interval 5s
    retry_forever true
    chunk_limit_size 8m
    queued_chunks_limit_size 128
  </buffer>
</match>
